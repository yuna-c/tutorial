<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<script>
			function test(delay, callback) {
				setTimeout(() => {
					callback();
				}, delay);
			}

			//수행할 미션 -start, 2초뒤에 test1 콘솔, 다시 2초뒤에 test2찍히고, 마지막 end
			//ES5에서 callback을 통해 동기화하는 원리
			//애초에 동기화시키고 싶은 코드를 모두 callback형태로 묶어 통채로 web api에게 넘김으로써
			//callstack입장에서 다음에 실행할 코드들을 원천적으로 제거 하는 방법

			//순서1 - start출력 (callstack)
			console.log('start');

			//순서2 - 첫번째 test함수 호출 (callstack)
			//순서3 - setTimeout을 web api에게 전달 (callstack)
			test(2000, () => {
				//순서4 - setTimeout호출하고 그 안쪽의 구문을 callstack에 전달 (web api)
				//순서5 - web api로 부터 setTimeout안쪽의 callback함수 전달받고 호출 (callstack)
				console.log('test1');

				//순서6 - 다시 두번째 test함수 호출하고 안쪽의 setTimeout을 다시 web api에게 전달 (callstack)
				test(2000, () => {
					//순서7 - setTimeout을 수행하고 아래쪽의 callback으로 전달된 구문을 다시 callstack에 전달 (web api)
					//순서8 - 아래 구문을 실행하고 종료 (callstack);
					console.log('test2');
					console.log('end');
				});
			});
		</script>
	</body>
</html>
